create token verification middleware
move logic from controllers to service file
refactor the routes